# Практическое внедрение фич "VX Racer"

Этот гайд помогает применить план из `docs/FEATURES.md`, если у вас есть исходный код и собранный EXE. Он разбит на шаги по настройке окружения, оценке текущей архитектуры и пошаговой интеграции карьеры, тайм-триала и гаража.

## 1. Подготовка окружения
- Создайте рабочую ветку от актуального main/master.
- Убедитесь, что билд настроен воспроизводимо: зафиксируйте версии SDK/движка, зависимости и команды сборки (CI или локально).
- Настройте быстрый цикл «правка → сборка → запуск» с автоматическими тестами/линтерами (например, pre-commit или CI job).
- Сравните поведение EXE и состояния в исходниках: проверьте, какие режимы уже реализованы и какие только частично.

## 2. Картирование системы игры
- Найдите точки входа гонки (сцены/уровни, загрузка трасс) и сервисы данных: сохранения, конфигурации трасс/машин, экономику.
- Зафиксируйте форматы данных, которые уже используются (JSON, ScriptableObjects, БД). Желательно добавить схемы/валидаторы.
- Отметьте, где UI рендерит экраны выбора гонки/гаража, и как он получает состояние (события, прямые вызовы, MVC/MVVM).

## 3. Внедрение карьерного режима
- **Данные кампании:** опишите этапы в отдельном конфиге (JSON/asset) с целями, призами, требованиями к допуску. Добавьте версионирование конфигов.
- **Прогрессия:** реализуйте сервис прогресса (уровень, деньги/кредиты, открытые трассы/машины) с автосохранением после гонки.
- **Интеграция с геймплеем:** при старте этапа подавайте конфиг миссии в гонку; при финише рассчитывайте награды и обновляйте прогресс.
- **UI:** экран карты/списка этапов, модалка результатов и кнопка «продолжить/повторить»; навигация назад в главное меню.

## 4. Внедрение тайм-триала
- **Режим:** добавьте отдельный пункт меню/сцену, фиксирующую параметры заезда (трасса, погода, авто/настройка).
- **Призрак:** сохраняйте траекторию/время игрока (поз. + таймстемпы) и грузите лучший «ghost» для отображения. Предусмотрите выключение в настройках.
- **Лидерборды:** локальное хранилище результатов и адаптер к онлайн-API (ретраи, валидация версии билда). Добавьте фильтры по трассе/машине.
- **UI:** таблица результатов с кнопкой «Побить рекорд», отображение личного лучшего, статусы синхронизации онлайн.

## 5. Внедрение гаража и кастомизации
- **Каталог косметики:** конфиг с красками, винилами, деталями (ID, редкость, требования к разблокировке). Привяжите цены к экономике кампании.
- **Применение:** система пресетов/скинов, которая загружает материалы и части при старте гонки; не меняет физику авто.
- **Разблокировки:** интеграция с прогрессом (этапы, достижения, задания дня). Добавьте всплывашки/баннеры об открытой косметике.
- **UI:** экран гаража с предпросмотром, категориями и сохранением пресета; подтверждение покупок/выборов.

## 6. Тестирование и контроль качества
- Юнит-тесты: сохранения, подсчёт наград, сортировка лидербордов, загрузка пресетов.
- Интеграционные тесты: запуск этапа кампании, отправка/загрузка результатов тайм-триала, применение кастомизации в гонке.
- Проверки данных: схемы для конфигов (JSON Schema/валидаторы), smoke-тест после сборки EXE.

## 7. Миграция и выпуск
- Если EXE уже публикуется, добавьте миграцию сохранений/конфигов при изменении форматов.
- Подготовьте release checklist: номер версии, changelog, проверка лидербордов, регрессия прогресса и гаража.
- Обновите экран настроек/меню, чтобы новые режимы были доступны и не ломали старые сейвы.

## 8. Как использовать готовый EXE
- Сравнивайте изменения: после каждой ключевой фичи делайте сборку и проверяйте функционал в EXE против планов.
- Если нужен билд для QA: подключите флаги/командную строку для быстрой загрузки сцен (карьера, тайм-триал, гараж) и для логирования.
- Храните тестовые сейвы и наборы конфигов, чтобы быстро воспроизводить сценарии (новый игрок, средний прогресс, конец кампании).
